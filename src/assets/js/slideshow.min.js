/*
	Copyright (c) 2014 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(ba,J,K){function L(a){$.each(a,function(a,b){c[a]=b});M="undefined"!==typeof c.isTouch?!!c.isTouch:"ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch}function w(){c.isManual||(N=s(function(){m()},c.interval))}function x(){clearTimeout(O);clearTimeout(N)}function s(a,b){return setTimeout(a,b||0)}function P(a){m.call(this,a,{isPrev:!1})}function Q(a){m.call(this,a,{isPrev:!0})}function m(a,d){var e=b.index,R=c.isCarousel?
	c.time:0;if(!n&&(p=d&&d.isPrev,ca.call(this,d&&d.slide),!b.slide.is(b.slideNext))){var f=K?K.call(b,a):!0;if(f||"undefined"===typeof f)n=!0,x(),a&&"hashchange"===a.type&&(R=0),t(B(e),R,function(){S(a)})}a?a.preventDefault():w()}function t(a,d,e,f){function g(){C=!1;a||0===a||(a=B(b.index));d=d||0;if(da&&c.isCarousel){f=f||0;if(d&&e)l.one(k.toLowerCase()+"TransitionEnd transitionend",e);y[k+"Transition"]=d?d/1E3+"s":"";y[k+"Transform"]="translateX("+-1*(z(a,!0)-f)+"%)";!d&&e&&e()}else l.stop(!0,!0).animate({left:z(a)+
	"%"},d,e)}T&&"undefined"!==typeof f?(C=!0,U=requestAnimationFrame(g)):g()}function S(a){b.slide=b.slideNext;n=!1;h.removeClass(c.classActive);b.slide.addClass(c.classActive);y[k+"Transition"]="";c.canLoop&&V();W();a&&("click"!==a.type&&"hashchange"!==a.type||s(function(){b.slide.focus()}),J&&J.call(b,a))}function ca(a){var d=$(this),e=b.index,g=f-1,d=d.is(u)?c.step:1;"undefined"!==typeof a?(p=a<e?!0:!1,e=a):p?(e-=d,e=0>=e?c.canLoop?v(e):0:e):(e+=d,e=e>=g?c.canLoop?v(e):g:e);b.slideNext=h.eq(e);b.index=
	e}function X(){return!c.canLoop&&(p&&0===b.index||!p&&b.index===f-1)}function Y(a){r&&(a?m.call(this,a,{slide:D.index(this)}):D.removeAttr("class").eq(b.index).addClass(c.classActive));E&&E.html("<strong>"+(b.index+1)+"</strong>/<strong>"+f+"</strong>")}function W(){var a,d=c.classDisabled;if(!c.canLoop){u.removeClass(d);switch(b.index){case 0:a=F;break;case f-1:a=G}a&&a.addClass(d)}Y()}function z(a,b){return b?100/f*a:-100*a}function v(a){a>=f&&(a-=f);0>a&&(a=f+a);return a}function B(a){return v(b.index+
	(c.canLoop?A-a:0))}function Z(a){return v(c.canLoop?a-A+b.index:a)}function aa(a){var d,e;b.slide||(b.slide=h.filter("."+c.classActive).first(),b.index=h.index(b.slide));location.hash&&(d=h.filter(location.hash),e=h.index(d),d.length&&b.index!==e&&m(a,{slide:e}));b.slide.length||(b.index=0,b.slide=h.eq(b.index));s(function(){g.scrollTop(0);g.scrollLeft(0)})}function V(){for(var a=f,d,e,g;a--;)d=h.eq(Z(a)),e=d.data("x"),g=z(a,!0)+"%",g!==e&&d.css({left:g,display:c.display}).attr("tabindex","-1").data("x",
	g);t(c.canLoop?A:b.index)}function ea(){var a,d;function e(e){var g=e.originalEvent,h=g.touches&&g.touches[0]||g;C||1<h.length||g.scale&&1!==g.scale||(a=(h.pageX||h.screenX)-k.x,d=(h.pageY||h.screenY)-k.y,"undefined"===typeof q&&(q=!!(q||Math.abs(a)<Math.abs(d))),q||(e.preventDefault(),x(),p=0<a,n=!0,!c.canLoop&&X()&&(a/=Math.abs(a)/b.width+1),t(null,null,null,a/b.width*(100/f))))}function h(){if(!q){var d=+new Date-k.time,f=Math.abs(a),d=250>d&&20<f||f>b.width/3;n=!1;T&&cancelAnimationFrame(U);d&&
	!X()?m.call(this,event,{isPrev:p}):0<f&&t(null,c.time)}g.off("touchmove pointermove MSPointerMove",e);g.off("touchend touchleave touchcancel MSPointerUp MSPointerOut MSPointerCancel pointerup pointerleave pointercancel",h)}function l(a){H&&clearTimeout(H);H=s(function(){b.width=g.outerWidth()},a?300:0)}var k;c.isCarousel=!0;g.on("touchstart pointerdown MSPointerDown",function(b){var c=u||r&&r.add(u),f=b.originalEvent,f=f.touches&&f.touches[0]||f;c.has(b.target).length||c.is(b.target)||(n&&S(),k={x:f.pageX||
	f.screenX,y:f.pageY||f.screenY,time:+new Date},q=d=a=void 0,g.on("touchmove pointermove MSPointerMove",e),g.on("touchend touchleave touchcancel MSPointerUp MSPointerOut MSPointerCancel pointerup pointerleave pointercancel",h))}).on("click",function(a){!q&&n&&a.preventDefault()}).addClass(c.classTouch);l();$(window).resize(l)}var b=this,I=["ms","O","Moz","Webkit",""],k="",y,c={next:"button.next",previous:"button.previous",markers:".markers",numbers:".numbers",classStrip:"strip",classSlide:"slide",
	classActive:"sticky",classDisabled:"disabled",classTouch:"touch",step:1,delay:3E3,interval:5E3,time:400,display:"block",canLoop:!1,isManual:!0,isCarousel:!0},g,h,l,r,D,E,u,F,G,O,N,H,U,f,A,n,C,q,p,M,da=function(){for(var a=document.body.style,b=I.length;b--;)if("string"===typeof a[I[b]+"Transition"]){k=I[b];break}return!!k}(),T=!(!window.requestAnimationFrame||!window.cancelAnimationFrame);L(ba||{});b.init=function(){g=$(c.slideshow);h=g.find("."+c.classSlide);l=g.find("."+c.classStrip);f=h.length;
	if(g.length&&!(2>f)){y=l[0].style;var a=h.first(),d=100/f+"%";l.outerWidth(100*f+"%");h.outerWidth(d);a.width()&&a.get(0).style.width.slice(0,4)===d.slice(0,4)||h.width(d);A=c.canLoop?Math.floor((f-1)/2):0;g.mouseenter(x).mouseleave(w);G=$(c.next).on("click touchend",P);F=$(c.previous).on("click touchend",Q);u=F.add(G);O=s(w,c.delay);if(c.markers){r=$(c.markers).on("click touchend","button",Y);for(a=f;a--;)r.prepend($("<button>"+(a+1)+"</button>"));D=r.find("button")}c.numbers&&(E=$(c.numbers).text("1/9"));
	aa();V();M&&ea();W();b.element=g;b.strip=l;b.slides=h;g.removeClass(c.classDisabled);$(window).on("hashchange",aa)}};b.start=w;b.stop=x;b.next=P;b.prev=Q;b.change=m;b.transition=t;b.getTransitionX=z;b.getIndexWrapped=v;b.getIndexOffset=B;b.getPositionOffset=Z;b.updateConfig=L};